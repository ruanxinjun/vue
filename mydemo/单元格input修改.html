<!DOCTYPE html>
<html>
<head>
	<meta charset=utf-8>
	<meta name=description content="">
	<meta name=viewport content="width=device-width, initial-scale=1">
	<title></title>
	<script src="lib/vue.js"></script>
	<script src="lib/vue-resource.js"></script>
	<link rel="stylesheet" type="text/css" href="lib/bootstrap.min.css"/>
</head>
<body>
<div id="box" class="container">
<div class="well">
{{apptitle}} --- 员工信息列表
</div>
<ol class="breadcrumb">
	<li>
		<a href="#" class="btn btn-sm btn-danger" @click="delall">删除</a>
	</li>
	<li>
		<a href="#" class="btn btn-sm btn-success">录入新员工</a>
	</li>
	<li>
	<input type="search"  id="skey"  width="200"><a href="#" class="btn btn-sm btn-info">员工搜索</a>
	</li>

</ol>
<table class="table table-hover table-striped">
	<thead>
		<tr class="alert alert-success">
			<th><input type="checkbox"  @click="checkall">ID</th>
			<th>姓名</th>
			<th>工资</th>
			<th>编辑</th>
		</tr>
	</thead>
	<tbody>
		<tr v-for="(user,index) of users">
			<td><input type="checkbox" :value="user.id" :checked="user.checked" @click.once="chksing($event,user.id)">{{user.id}}</td>
			<td>{{user.name}}</td>
			<td>{{user.salary}}</td>
			<td>
				<button type="button" class="btn btn-info">编辑</button>
				<button type="button" class="btn btn-warning" @click="delsin(index,user.id)">删除</button>
			</td>
		</tr>
		<tr>
			<td colspan="4" class="text-center">{{status}}</td>
		</tr>
	</tbody>
</table>
</div>
<script>
	var app = new Vue({
		el:'#box',
		data:function(){
			return {
				status:'无全选',
				ckall:false,
				apptitle:'单元格input修改',
				selitem:[],
				users:[
					{id:1001,name:'阮新军',salary:1500,checked:false},
					{id:2008,name:'别毛风',salary:2500,checked:false},
					{id:2511,name:'李小鲁',salary:3000,checked:false}
				]
			}
		},
		watch:{
			ckall:function(v){
				this.status = v?'全选':'无全选';
				var _selitem = this.selitem;
				if(v){
					this.users.forEach(function(item){
						_selitem.push(item);
						item.checked=true;
					});
				}else{
					this.users.forEach(function(item){
						item.checked=false;
					});
					_selitem = [];
				}
				this.selitem = _selitem;
			}
		},
		methods:{
			checkall:function(event){
				this.ckall = event.currentTarget.checked?true:false;
			},
			chksing:function(event,id){
				
			},
			delall:function(){
			
				if(!this.selitem)
					return;

				//从数据库删除
				var wd = '';
				this.selitem.forEach(function(item){
				   wd+=item.id+',';
				});
				
				this.$http.jsonp('https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su',{wd:'a'},{jsonp:'cb'})
				.then(
					function(res){
						this.status = res.data.s;
						this.users = [];
					},
					function(error){
						this.status = '错误：'+error.status;
					}
				);

				this.selitem = [];

			},
			delsin:function(_index,_userid){

			}
		}
	});
</script>
</body>
</html>